<!doctype html>
<html lang="en">
<head>
<meta charset="UTF-8">
<meta name="viewport" content="width=device-width">
<meta name="generator" content="Docusaurus v2.0.0-alpha.61">
<title data-react-helmet="true">Docker | Creative Mixed-use Matching Platform Documentation</title><meta data-react-helmet="true" name="twitter:card" content="summary_large_image"><meta data-react-helmet="true" property="og:title" content="Docker | Creative Mixed-use Matching Platform Documentation"><meta data-react-helmet="true" name="description" content="Docker Best Practices"><meta data-react-helmet="true" property="og:description" content="Docker Best Practices"><meta data-react-helmet="true" property="og:url" content="https://lesterlyu.github.io/cmmp-docs/docker"><link data-react-helmet="true" rel="shortcut icon" href="/cmmp-docs/img/favicon.ico"><link data-react-helmet="true" rel="canonical" href="https://lesterlyu.github.io/cmmp-docs/docker"><link rel="stylesheet" href="/cmmp-docs/styles.4b4de0ba.css">
<link rel="preload" href="/cmmp-docs/styles.4408798e.js" as="script">
<link rel="preload" href="/cmmp-docs/runtime~main.e0af0bf2.js" as="script">
<link rel="preload" href="/cmmp-docs/main.f26d4b9d.js" as="script">
<link rel="preload" href="/cmmp-docs/1.01bb7bb8.js" as="script">
<link rel="preload" href="/cmmp-docs/2.a7e25503.js" as="script">
<link rel="preload" href="/cmmp-docs/24.64a99bb2.js" as="script">
<link rel="preload" href="/cmmp-docs/21c35973.567d5427.js" as="script">
<link rel="preload" href="/cmmp-docs/17896441.74213b76.js" as="script">
<link rel="preload" href="/cmmp-docs/2bb6c541.cd922ca9.js" as="script">
</head>
<body>
<script>!function(){function t(t){document.documentElement.setAttribute("data-theme",t)}var e=function(){var t=null;try{t=localStorage.getItem("theme")}catch(t){}return t}();t(null!==e?e:"light")}()</script><div id="__docusaurus">
<nav class="navbar navbar--light navbar--fixed-top"><div class="navbar__inner"><div class="navbar__items"><div aria-label="Navigation bar toggle" class="navbar__toggle" role="button" tabindex="0"><svg xmlns="http://www.w3.org/2000/svg" width="30" height="30" viewBox="0 0 30 30" role="img" focusable="false"><title>Menu</title><path stroke="currentColor" stroke-linecap="round" stroke-miterlimit="10" stroke-width="2" d="M4 7h22M4 15h22M4 23h22"></path></svg></div><a class="navbar__brand" href="/cmmp-docs/"><img class="navbar__logo" src="/cmmp-docs/img/logo.svg" alt="My Facebook Project Logo"><strong class="navbar__title">Creative Mixed-use Matching Platform Documentation</strong></a></div><div class="navbar__items navbar__items--right"><a href="https://github.com/drosu/creative_mixed-use_matching_platform" target="_blank" rel="noopener noreferrer" class="navbar__item navbar__link">GitHub</a><div class="react-toggle react-toggle--disabled displayOnlyInLargeViewport_2aTZ"><div class="react-toggle-track"><div class="react-toggle-track-check"><span class="toggle_BsTx">🌜</span></div><div class="react-toggle-track-x"><span class="toggle_BsTx">🌞</span></div></div><div class="react-toggle-thumb"></div><input type="checkbox" disabled="" aria-label="Dark mode toggle" class="react-toggle-screenreader-only"></div></div></div><div role="presentation" class="navbar-sidebar__backdrop"></div><div class="navbar-sidebar"><div class="navbar-sidebar__brand"><a class="navbar__brand" href="/cmmp-docs/"><img class="navbar__logo" src="/cmmp-docs/img/logo.svg" alt="My Facebook Project Logo"><strong class="navbar__title">Creative Mixed-use Matching Platform Documentation</strong></a></div><div class="navbar-sidebar__items"><div class="menu"><ul class="menu__list"><li class="menu__list-item"><a href="https://github.com/drosu/creative_mixed-use_matching_platform" target="_blank" rel="noopener noreferrer" class="menu__link">GitHub</a></li></ul></div></div></div></nav><div class="main-wrapper"><div class="docPage_2gpo"><div class="docSidebarContainer_3_JD" role="complementary"><div class="sidebar_2urC"><div class="menu menu--responsive menu_5FrY"><button aria-label="Open Menu" aria-haspopup="true" class="button button--secondary button--sm menu__button" type="button"><svg aria-label="Menu" class="sidebarMenuIcon_Dm3K" xmlns="http://www.w3.org/2000/svg" height="24" width="24" viewBox="0 0 32 32" role="img" focusable="false"><title>Menu</title><path stroke="currentColor" stroke-linecap="round" stroke-miterlimit="10" stroke-width="2" d="M4 7h22M4 15h22M4 23h22"></path></svg></button><ul class="menu__list"><li class="menu__list-item menu__list-item--collapsed"><a class="menu__link menu__link--sublist" href="#!">Getting Started</a><ul class="menu__list"><li class="menu__list-item"><a class="menu__link" tabindex="-1" href="/cmmp-docs/">Installation for Developer</a></li><li class="menu__list-item"><a class="menu__link" tabindex="-1" href="/cmmp-docs/development">Development</a></li><li class="menu__list-item"><a class="menu__link" tabindex="-1" href="/cmmp-docs/deployment">Deployment</a></li></ul></li><li class="menu__list-item"><a class="menu__link menu__link--sublist menu__link--active" href="#!">Developer Manual</a><ul class="menu__list"><li class="menu__list-item"><a aria-current="page" class="menu__link menu__link--active active" tabindex="0" href="/cmmp-docs/docker">Docker</a></li><li class="menu__list-item"><a class="menu__link" tabindex="0" href="/cmmp-docs/registration">Registration Workflow</a></li></ul></li><li class="menu__list-item menu__list-item--collapsed"><a class="menu__link menu__link--sublist" href="#!">Backend Developer Manual</a><ul class="menu__list"><li class="menu__list-item"><a class="menu__link" tabindex="-1" href="/cmmp-docs/backend/introduction">Introduction</a></li><li class="menu__list-item"><a class="menu__link" tabindex="-1" href="/cmmp-docs/backend/models">Models</a></li><li class="menu__list-item"><a class="menu__link" tabindex="-1" href="/cmmp-docs/backend/apis">APIs</a></li><li class="menu__list-item"><a class="menu__link" tabindex="-1" href="/cmmp-docs/backend/mocha">Automation Tests</a></li></ul></li><li class="menu__list-item menu__list-item--collapsed"><a class="menu__link menu__link--sublist" href="#!">Frontend Developer Manual</a><ul class="menu__list"><li class="menu__list-item"><a class="menu__link" tabindex="-1" href="/cmmp-docs/frontend/introduction">Introduction</a></li><li class="menu__list-item"><a class="menu__link" tabindex="-1" href="/cmmp-docs/frontend/file-structure">File Structure</a></li><li class="menu__list-item"><a class="menu__link" tabindex="-1" href="/cmmp-docs/frontend/build">Run and Build</a></li><li class="menu__list-item"><a class="menu__link" tabindex="-1" href="/cmmp-docs/frontend/input-builder">Input Builder</a></li></ul></li><li class="menu__list-item menu__list-item--collapsed"><a class="menu__link menu__link--sublist" href="#!">Examples</a><ul class="menu__list"><li class="menu__list-item"><a class="menu__link" tabindex="-1" href="/cmmp-docs/doc1">Style Guide</a></li><li class="menu__list-item"><a class="menu__link" tabindex="-1" href="/cmmp-docs/doc2">Document Number 2</a></li><li class="menu__list-item"><a class="menu__link" tabindex="-1" href="/cmmp-docs/doc3">This is Document Number 3</a></li></ul></li><li class="menu__list-item menu__list-item--collapsed"><a class="menu__link menu__link--sublist" href="#!">Features</a><ul class="menu__list"><li class="menu__list-item"><a class="menu__link" tabindex="-1" href="/cmmp-docs/mdx">Powered by MDX</a></li></ul></li></ul></div></div></div><main class="docMainContainer_3EyW"><div class="container padding-vert--lg docItemWrapper_1EkI"><div class="row"><div class="col docItemCol_2ASc"><div class="docItemContainer_3QWW"><article><header><h1 class="docTitle_1Lrw">Docker</h1></header><div class="markdown"><h2><a aria-hidden="true" tabindex="-1" class="anchor enhancedAnchor_2cZh" id="docker-best-practices"></a>Docker Best Practices<a aria-hidden="true" tabindex="-1" class="hash-link" href="#docker-best-practices" title="Direct link to heading">#</a></h2><div class="admonition admonition-note alert alert--secondary"><div class="admonition-heading"><h5><span class="admonition-icon"><svg xmlns="http://www.w3.org/2000/svg" width="14" height="16" viewBox="0 0 14 16"><path fill-rule="evenodd" d="M6.3 5.69a.942.942 0 0 1-.28-.7c0-.28.09-.52.28-.7.19-.18.42-.28.7-.28.28 0 .52.09.7.28.18.19.28.42.28.7 0 .28-.09.52-.28.7a1 1 0 0 1-.7.3c-.28 0-.52-.11-.7-.3zM8 7.99c-.02-.25-.11-.48-.31-.69-.2-.19-.42-.3-.69-.31H6c-.27.02-.48.13-.69.31-.2.2-.3.44-.31.69h1v3c.02.27.11.5.31.69.2.2.42.31.69.31h1c.27 0 .48-.11.69-.31.2-.19.3-.42.31-.69H8V7.98v.01zM7 2.3c-3.14 0-5.7 2.54-5.7 5.68 0 3.14 2.56 5.7 5.7 5.7s5.7-2.55 5.7-5.7c0-3.15-2.56-5.69-5.7-5.69v.01zM7 .98c3.86 0 7 3.14 7 7s-3.14 7-7 7-7-3.12-7-7 3.14-7 7-7z"></path></svg></span>note</h5></div><div class="admonition-content"><p>Also take a look of the <a href="https://docs.docker.com/develop/dev-best-practices/" target="_blank" rel="noopener noreferrer">Best practice for docker development</a>
&amp; <a href="https://docs.docker.com/develop/develop-images/dockerfile_best-practices/" target="_blank" rel="noopener noreferrer">Best practice for writing Dockerfiles</a></p></div></div><h3><a aria-hidden="true" tabindex="-1" class="anchor enhancedAnchor_2cZh" id="keep-the-image-small"></a>Keep the image small<a aria-hidden="true" tabindex="-1" class="hash-link" href="#keep-the-image-small" title="Direct link to heading">#</a></h3><p>Start with an appropriate base image. For example, we want a node.js environment, we can search nodejs images. There
are a few <a href="https://hub.docker.com/_/node/?tab=description" target="_blank" rel="noopener noreferrer">image variants for nodejs</a>:</p><ul><li><code>node:14</code> ~345MB</li><li><code>node:14-stretch</code> ~345MB</li><li><code>node:14-buster</code> ~322MB</li><li><code>node:14-slim</code> ~57MB</li><li><code>node:14-alpine</code> ~28MB</li></ul><p>As you see, each variant come with different image size. Personally I prefer the <code>slim</code> version for Node.js, as
<code>alpine</code> images may have some compatibility issue with some packages that is designed for Ubuntu/Debian.</p><h3><a aria-hidden="true" tabindex="-1" class="anchor enhancedAnchor_2cZh" id="dont-install-unnecessary-packages"></a>Don’t install unnecessary packages<a aria-hidden="true" tabindex="-1" class="hash-link" href="#dont-install-unnecessary-packages" title="Direct link to heading">#</a></h3><p>To reduce complexity, dependencies, file sizes, and build times, avoid installing extra or
unnecessary packages just because they might be “nice to have.” For example,
you don’t need to include a text editor in a database container.</p><h3><a aria-hidden="true" tabindex="-1" class="anchor enhancedAnchor_2cZh" id="decouple-the-application"></a>Decouple the application<a aria-hidden="true" tabindex="-1" class="hash-link" href="#decouple-the-application" title="Direct link to heading">#</a></h3><p>Each container should have only one concern. Decoupling applications into multiple containers makes
it easier to scale horizontally and reuse containers. For example, a web application should have
database and server as two separate containers.</p><h3><a aria-hidden="true" tabindex="-1" class="anchor enhancedAnchor_2cZh" id="how-to-persist-application-data"></a>How to persist application data?<a aria-hidden="true" tabindex="-1" class="hash-link" href="#how-to-persist-application-data" title="Direct link to heading">#</a></h3><p>In the case that the docker image updates, the whole container recreates and does not persist the
internal data. If we want to keep the data of the container, docker volumes requires to persist the data
for you application. </p><p>For example, MongoDB&#x27;s default data storage path is <code>/data/db</code>, so we want to mount a dedicated volume
to <code>/data/db</code>. We should modify <code>docker-compose.yaml</code>.</p><div class="mdxCodeBlock_1XEh"><div class="codeBlockContent_1u-d"><button type="button" aria-label="Copy code to clipboard" class="copyButton_10dd">Copy</button><div tabindex="0" class="prism-code language-yaml codeBlock_3iAC"><div class="codeBlockLines_b7E3" style="color:#bfc7d5;background-color:#292d3e"><div class="token-line" style="color:#bfc7d5"><span class="token key atrule">version</span><span class="token punctuation" style="color:rgb(199, 146, 234)">:</span><span class="token plain"> </span><span class="token string" style="color:rgb(195, 232, 141)">&quot;3.8&quot;</span><span class="token plain"></span></div><div class="token-line" style="color:#bfc7d5"><span class="token plain"></span><span class="token key atrule">services</span><span class="token punctuation" style="color:rgb(199, 146, 234)">:</span><span class="token plain"></span></div><div class="token-line" style="color:#bfc7d5"><span class="token plain"></span><span class="token key atrule">mongodb</span><span class="token punctuation" style="color:rgb(199, 146, 234)">:</span><span class="token plain"></span></div><div class="token-line" style="color:#bfc7d5"><span class="token plain">  </span><span class="token key atrule">volumes</span><span class="token punctuation" style="color:rgb(199, 146, 234)">:</span><span class="token plain"></span></div><div class="token-line" style="color:#bfc7d5"><span class="token plain">    </span><span class="token punctuation" style="color:rgb(199, 146, 234)">-</span><span class="token plain"> mongodb_data</span><span class="token punctuation" style="color:rgb(199, 146, 234)">:</span><span class="token plain">/data/db</span></div><div class="token-line" style="color:#bfc7d5"><span class="token plain"></span><span class="token key atrule">volumes</span><span class="token punctuation" style="color:rgb(199, 146, 234)">:</span><span class="token plain"></span></div><div class="token-line" style="color:#bfc7d5"><span class="token plain">  mongodb_data</span><span class="token punctuation" style="color:rgb(199, 146, 234)">:</span></div></div></div></div></div><h3><a aria-hidden="true" tabindex="-1" class="anchor enhancedAnchor_2cZh" id="how-to-access-a-folder-from-the-host-why"></a>How to access a folder from the host? why?<a aria-hidden="true" tabindex="-1" class="hash-link" href="#how-to-access-a-folder-from-the-host-why" title="Direct link to heading">#</a></h3><p>A docker container is just a dedicated environment for a specific application. For development,
we usually keep the application code in our host system instead of a docker container, and we mount
that folder that contains the application code to the docker container.</p><p>For example, the server code resides in <code>./server</code>, we mount <code>./server</code> from the host to
<code>/root/server</code> in the docker container:</p><div class="mdxCodeBlock_1XEh"><div class="codeBlockContent_1u-d"><button type="button" aria-label="Copy code to clipboard" class="copyButton_10dd">Copy</button><div tabindex="0" class="prism-code language-yaml codeBlock_3iAC"><div class="codeBlockLines_b7E3" style="color:#bfc7d5;background-color:#292d3e"><div class="token-line" style="color:#bfc7d5"><span class="token key atrule">version</span><span class="token punctuation" style="color:rgb(199, 146, 234)">:</span><span class="token plain"> </span><span class="token string" style="color:rgb(195, 232, 141)">&quot;3.8&quot;</span><span class="token plain"></span></div><div class="token-line" style="color:#bfc7d5"><span class="token plain"></span><span class="token key atrule">services</span><span class="token punctuation" style="color:rgb(199, 146, 234)">:</span><span class="token plain"></span></div><div class="token-line" style="color:#bfc7d5"><span class="token plain">  </span><span class="token key atrule">server</span><span class="token punctuation" style="color:rgb(199, 146, 234)">:</span><span class="token plain"></span></div><div class="token-line" style="color:#bfc7d5"><span class="token plain">    </span><span class="token key atrule">volumes</span><span class="token punctuation" style="color:rgb(199, 146, 234)">:</span><span class="token plain"></span></div><div class="token-line" style="color:#bfc7d5"><span class="token plain">      </span><span class="token punctuation" style="color:rgb(199, 146, 234)">-</span><span class="token plain"> ./server</span><span class="token punctuation" style="color:rgb(199, 146, 234)">:</span><span class="token plain">/root/server</span></div></div></div></div></div><p>If the server supports auto-reload, which is yes in our case, changes made on the host will trigger
an auto-reload in the docker container.</p><h3><a aria-hidden="true" tabindex="-1" class="anchor enhancedAnchor_2cZh" id="logging"></a>Logging<a aria-hidden="true" tabindex="-1" class="hash-link" href="#logging" title="Direct link to heading">#</a></h3><p>You can configure the logging driver, address, size, number of files</p><div class="admonition admonition-important alert alert--info"><div class="admonition-heading"><h5><span class="admonition-icon"><svg xmlns="http://www.w3.org/2000/svg" width="14" height="16" viewBox="0 0 14 16"><path fill-rule="evenodd" d="M7 2.3c3.14 0 5.7 2.56 5.7 5.7s-2.56 5.7-5.7 5.7A5.71 5.71 0 0 1 1.3 8c0-3.14 2.56-5.7 5.7-5.7zM7 1C3.14 1 0 4.14 0 8s3.14 7 7 7 7-3.14 7-7-3.14-7-7-7zm1 3H6v5h2V4zm0 6H6v2h2v-2z"></path></svg></span>important</h5></div><div class="admonition-content"><p>Please see the official documentation <a href="https://docs.docker.com/compose/compose-file/#logging" target="_blank" rel="noopener noreferrer">https://docs.docker.com/compose/compose-file/#logging</a></p></div></div></div></article><div class="margin-vert--xl"><div class="row"><div class="col"><a href="https://github.com/drosu/creative_mixed-use_matching_platform/edit/master/docs/docs/docker.md" target="_blank" rel="noreferrer noopener"><svg fill="currentColor" height="1.2em" width="1.2em" preserveAspectRatio="xMidYMid meet" viewBox="0 0 40 40" style="margin-right:0.3em;vertical-align:sub"><g><path d="m34.5 11.7l-3 3.1-6.3-6.3 3.1-3q0.5-0.5 1.2-0.5t1.1 0.5l3.9 3.9q0.5 0.4 0.5 1.1t-0.5 1.2z m-29.5 17.1l18.4-18.5 6.3 6.3-18.4 18.4h-6.3v-6.2z"></path></g></svg>Edit this page</a></div></div></div><div class="margin-vert--lg"><nav class="pagination-nav" aria-label="Blog list page navigation"><div class="pagination-nav__item"><a class="pagination-nav__link" href="/cmmp-docs/deployment"><div class="pagination-nav__sublabel">Previous</div><div class="pagination-nav__label">« Deployment</div></a></div><div class="pagination-nav__item pagination-nav__item--next"><a class="pagination-nav__link" href="/cmmp-docs/registration"><div class="pagination-nav__sublabel">Next</div><div class="pagination-nav__label">Registration Workflow »</div></a></div></nav></div></div></div><div class="col col--3"><div class="tableOfContents_3klQ"><ul class="table-of-contents table-of-contents__left-border"><li><a href="#docker-best-practices" class="table-of-contents__link">Docker Best Practices</a><ul><li><a href="#keep-the-image-small" class="table-of-contents__link">Keep the image small</a></li><li><a href="#dont-install-unnecessary-packages" class="table-of-contents__link">Don’t install unnecessary packages</a></li><li><a href="#decouple-the-application" class="table-of-contents__link">Decouple the application</a></li><li><a href="#how-to-persist-application-data" class="table-of-contents__link">How to persist application data?</a></li><li><a href="#how-to-access-a-folder-from-the-host-why" class="table-of-contents__link">How to access a folder from the host? why?</a></li><li><a href="#logging" class="table-of-contents__link">Logging</a></li></ul></li></ul></div></div></div></div></main></div></div><footer class="footer footer--dark"><div class="container"><div class="text--center"><div class="margin-bottom--sm"><a href="https://opensource.facebook.com" target="_blank" rel="noopener noreferrer" class="footerLogoLink_1zJy"><img class="footer__logo" alt="Facebook Open Source Logo" src="/cmmp-docs/img/oss_logo.png"></a></div><div>Copyright © 2020 Facebook, Inc. Built with Docusaurus.</div></div></div></footer></div>
<script src="/cmmp-docs/styles.4408798e.js"></script>
<script src="/cmmp-docs/runtime~main.e0af0bf2.js"></script>
<script src="/cmmp-docs/main.f26d4b9d.js"></script>
<script src="/cmmp-docs/1.01bb7bb8.js"></script>
<script src="/cmmp-docs/2.a7e25503.js"></script>
<script src="/cmmp-docs/24.64a99bb2.js"></script>
<script src="/cmmp-docs/21c35973.567d5427.js"></script>
<script src="/cmmp-docs/17896441.74213b76.js"></script>
<script src="/cmmp-docs/2bb6c541.cd922ca9.js"></script>
</body>
</html>